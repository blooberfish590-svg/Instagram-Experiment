<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>vues_naturelles - Profil Nature</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Roboto', sans-serif;
      background: #fafafa;
      max-width: 600px;
      margin: 20px auto;
      color: #262626;
    }
    header {
      display: flex;
      padding: 20px;
      align-items: center;
      border-bottom: 1px solid #dbdbdb;
      background: white;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .avatar {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      margin-right: 20px;
      border: 2px solid #3897f0;
    }
    .profile-info { flex: 1; }
    .username {
      font-weight: 700;
      font-size: 1.6em;
      margin-bottom: 4px;
    }
    .bio {
      font-size: 0.9em;
      color: #8e8e8e;
      margin-bottom: 12px;
    }
    .follow-stats {
      display: flex;
      gap: 20px;
    }
    .follow-stats div {
      font-weight: 700;
    }
    .follow-stats div span {
      font-weight: 400;
      color: #8e8e8e;
      margin-left: 5px;
    }
    main {
      padding: 10px 0;
    }
    .posts-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2px;
    }
    .post {
      position: relative;
      cursor: pointer;
      overflow: hidden;
      background: black;
      aspect-ratio: 1 / 1;
    }
    .post img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    .post:hover img,
    .post:focus img {
      transform: scale(1.1);
    }
    #modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      justify-content: center;
      align-items: center;
      z-index: 2000;
      padding: 15px;
    }
    #modal.active {
      display: flex;
    }
    #modal-content {
      background: white;
      max-width: 500px;
      width: 100%;
      border-radius: 12px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    #modal-header {
      display: flex;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid #dbdbdb;
    }
    #modal-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      margin-right: 12px;
      border: 2px solid #3897f0;
    }
    #modal-username {
      font-weight: 700;
      font-size: 1.1em;
    }
    #modal-close {
      margin-left: auto;
      font-size: 28px;
      cursor: pointer;
      color: #999;
    }
    #modal-close:hover {
      color: #333;
    }
    #modal-image {
      width: 100%;
      max-height: 350px;
      object-fit: cover;
    }
    #modal-interactions {
      padding: 15px;
    }
    .buttons {
      display: flex;
      gap: 20px;
      margin-bottom: 10px;
    }
    button {
      background: none;
      border: none;
      font-size: 1.8em;
      cursor: pointer;
      color: #262626;
      transition: color 0.3s;
      user-select: none;
    }
    button:hover {
      color: #3897f0;
    }
    button.liked {
      color: #ed4956;
    }
    button.shared {
      color: #42a5f5;
    }
    #stats-text {
      font-weight: 700;
      margin-bottom: 12px;
    }
    #comments-list {
      max-height: 140px;
      overflow-y: auto;
      margin-bottom: 12px;
      border-top: 1px solid #dbdbdb;
      padding-top: 10px;
    }
    .comment {
      margin-bottom: 8px;
      font-size: 0.9em;
    }
    .comment strong {
      margin-right: 6px;
    }
    #comment-form {
      display: flex;
      gap: 10px;
    }
    #comment-input {
      flex: 1;
      padding: 8px 10px;
      border: 1px solid #dbdbdb;
      border-radius: 20px;
      font-size: 1em;
    }
    #comment-submit {
      background: none;
      border: none;
      color: #3897f0;
      font-weight: 700;
      cursor: pointer;
      font-size: 1em;
      padding: 0 10px;
    }
    #comment-submit:disabled {
      color: #ccc;
      cursor: default;
    }
    #comments-list::-webkit-scrollbar {
      width: 5px;
    }
    #comments-list::-webkit-scrollbar-thumb {
      background-color: #ccc;
      border-radius: 10px;
    }
  </style>
</head>
<body>

<header>
  <div class="avatar" style="background-image:
    url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=200&q=80')"></div>
  <div class="profile-info">
    <div class="username">vues_naturelles</div>
    <div class="bio">Partage des plus beaux paysages du monde ðŸŒ„ðŸŒ¿</div>
    <div class="follow-stats">
      <div><strong>24,567</strong><span> abonnÃ©s</span></div>
      <div><strong>482</strong><span> abonnements</span></div>
    </div>
  </div>
</header>

<main>
  <div class="posts-grid" id="posts-grid" aria-live="polite" aria-label="Galerie de photos"></div>
</main>

<!-- Modal -->
<div id="modal" role="dialog" aria-modal="true" aria-labelledby="modal-username">
  <div id="modal-content">
    <div id="modal-header">
      <div id="modal-avatar" style="background-image:
        url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=200&q=80')"></div>
      <div id="modal-username">vues_naturelles</div>
      <div id="modal-close" onclick="closeModal()" aria-label="Fermer"
           tabindex="0" role="button">&times;</div>
    </div>
    <img id="modal-image" src="" alt="Photo du post agrandie" />
    <div id="modal-interactions">
      <div class="buttons">
        <button id="like-button" title="Jâ€™aime" aria-pressed="false"
                onclick="toggleLike()" aria-label="Bouton jâ€™aime">â™¡</button>
        <button id="share-button" title="Partager" aria-pressed="false"
                onclick="toggleShare()" aria-label="Bouton partager">â†»</button>
        <button id="comment-button" title="Commenter"
                onclick="focusComment()" aria-label="Bouton commenter">ðŸ’¬</button>
      </div>
      <div id="stats-text" aria-live="polite"></div>
      <div id="comments-list" aria-live="polite"></div>
      <form id="comment-form" onsubmit="submitComment(event)"
            aria-label="Formulaire de commentaire">
        <input
          type="text"
          id="comment-input"
          placeholder="Ajouter un commentaire..."
          aria-label="Ajouter un commentaire"
          autocomplete="off"
          required
        />
        <button type="submit" id="comment-submit" disabled>Publier</button>
      </form>
    </div>
  </div>
</div>

<script>
  // Your Google Form submit URL (formResponse endpoint)
  const googleFormBaseURL = 'https://docs.google.com/forms/d/e/1FAIpQLSffRo_iBkQpoZs4tBHE8XsbQjCDoqQDUphDQMfcxfHSqJxS6A/formResponse';

  // Map your entry IDs (likes and comments) per post
  const googleFormEntryIDs = {
    1: { like: 'entry.101173465', comment: 'entry.2047071178' },
    2: { like: 'entry.2104023893', comment: 'entry.1287388776' },
    3: { like: 'entry.744453841',  comment: 'entry.1080020578' },
    4: { like: 'entry.2145982999', comment: 'entry.200964838' },
    5: { like: 'entry.90484567',   comment: 'entry.2000027487' },
    6: { like: 'entry.750466602',  comment: 'entry.1558323089' },
    7: { like: 'entry.1856103927', comment: 'entry.1614154253' },
    8: { like: 'entry.157235196',  comment: 'entry.189285210' },
    9: { like: 'entry.1813427459', comment: 'entry.217981815' },
    10:{ like: 'entry.909669417',  comment: 'entry.1548024541' }
  };

  // Posts data: 5 high-engagement, 5 low-engagement
  const posts = [
    // High engagement
    {
      postId: 1,
      image: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=800&q=80',
      likes: 1200,
      comments: [
        { user: 'Alice', text: 'Magnifique !' },
        { user: 'Bob', text: 'Jâ€™adore cet endroit.' },
        { user: 'ChloÃ©', text: 'Tellement paisible.' },
        { user: 'David', text: 'Je rÃªve dâ€™y aller.' },
        { user: 'Eva', text: 'Les couleurs sont incroyables.' }
      ],
      shares: 50
    },
    {
      postId: 2,
      image: 'https://images.unsplash.com/photo-1500534623283-312aade485b7?auto=format&fit=crop&w=800&q=80',
      likes: 980,
      comments: [
        { user: 'Fiona', text: 'Wow, incroyable!' },
        { user: 'George', text: 'La beautÃ© naturelle.' },
        { user: 'Hugo', text: 'Tellement serein.' }
      ],
      shares: 30
    },
    {
      postId: 3,
      image: 'https://images.unsplash.com/photo-1468071174046-657d9d351a40?auto=format&fit=crop&w=800&q=80',
      likes: 750,
      comments: [
        { user: 'Jules', text: 'Cette lumiÃ¨re est parfaite.' },
        { user: 'Klara', text: 'Jâ€™aime la tranquillitÃ© ici.' }
      ],
      shares: 20
    },
    {
      postId: 4,
      image: 'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=800&q=80',
      likes: 1300,
      comments: [
        { user: 'LÃ©a', text: 'Câ€™est superbe!' },
        { user: 'Marc', text: 'La nature est magique.' }
      ],
      shares: 45
    },
    {
      postId: 5,
      image: 'https://images.unsplash.com/photo-1445820133077-ec956e595e9b?auto=format&fit=crop&w=800&q=80',
      likes: 640,
      comments: [
        { user: 'Olivier', text: 'Magnifique panorama.' },
        { user: 'Pauline', text: 'Tellement calme ici.' }
      ],
      shares: 15
    },
    // Low engagement
    {
      postId: 6,
      image: 'https://images.unsplash.com/photo-1442406964439-e46ab8eff7c4?auto=format&fit=crop&w=800&q=80',
      likes: 8,
      comments: [],
      shares: 0
    },
    {
      postId: 7,
      image: 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=800&q=80',
      likes: 5,
      comments: [],
      shares: 0
    },
    {
      postId: 8,
      image: 'https://images.unsplash.com/photo-1472214103451-9374bd1c798e?auto=format&fit=crop&w=800&q=80',
      likes: 10,
      comments: [],
      shares: 0
    },
    {
      postId: 9,
      image: 'https://images.unsplash.com/photo-1500534314209-a25be79f67ae?auto=format&fit=crop&w=800&q=80',
      likes: 7,
      comments: [],
      shares: 0
    },
    {
      postId: 10,
      image: 'https://images.unsplash.com/photo-1465311443246-53f25002f8ca?auto=format&fit=crop&w=800&q=80',
      likes: 6,
      comments: [],
      shares: 0
    }
  ];

  // Shuffle utility
  function shuffle(array) {
    let current = array.length, t, i;
    while (current !== 0) {
      i = Math.floor(Math.random() * current);
      current--;
      t = array[current];
      array[current] = array[i];
      array[i] = t;
    }
    return array;
  }

  const postsGrid = document.getElementById('posts-grid');
  const modal = document.getElementById('modal');
  const modalImage = document.getElementById('modal-image');
  const likeButton = document.getElementById('like-button');
  const shareButton = document.getElementById('share-button');
  const commentsList = document.getElementById('comments-list');
  const commentForm = document.getElementById('comment-form');
  const commentInput = document.getElementById('comment-input');
  const commentSubmit = document.getElementById('comment-submit');
  let currentPost = null;
  let liked = false;
  let shared = false;
  let modalLikes = 0, modalShares = 0, modalComments = [];

  function renderPosts() {
    postsGrid.innerHTML = '';
    shuffle(posts);
    posts.forEach(post => {
      const div = document.createElement('div');
      div.className = 'post';
      div.setAttribute('tabindex', 0);
      div.setAttribute('role', 'button');
      div.setAttribute('aria-label', `Photo paysage numÃ©ro ${post.postId}`);
      div.dataset.postId = post.postId;
      const img = document.createElement('img');
      img.src = post.image;
      img.alt = `Paysage ${post.postId}`;
      div.appendChild(img);
      div.onclick = () => openModal(post);
      div.onkeypress = e => {
        if (e.key === 'Enter' || e.key === ' ') {
          openModal(post);
          e.preventDefault();
        }
      };
      postsGrid.appendChild(div);
    });
  }

  function openModal(post) {
    currentPost = post;
    liked = false;
    shared = false;
    modalLikes = post.likes;
    modalShares = post.shares || 0;
    modalComments = post.comments.slice();

    modalImage.src = post.image;
    updateStatsText();
    renderComments();
    updateLikeButton(false);
    updateShareButton(false);
    commentInput.value = '';
    commentSubmit.disabled = true;

    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    modal.classList.remove('active');
    document.body.style.overflow = '';
    currentPost = null;
  }

  window.addEventListener('keydown', e => {
    if (e.key === 'Escape' && modal.classList.contains('active')) {
      closeModal();
    }
  });

  function updateStatsText() {
    const text = `${modalLikes} jâ€™aime${modalLikes > 1 ? 's' : ''} â€¢ ${modalShares} partage${modalShares > 1 ? 's' : ''} â€¢ ${modalComments.length} commentaire${modalComments.length > 1 ? 's' : ''}`;
    document.getElementById('stats-text').textContent = text;
  }

  function updateLikeButton(isLiked) {
    likeButton.textContent = isLiked ? 'â™¥' : 'â™¡';
    likeButton.classList.toggle('liked', isLiked);
    likeButton.setAttribute('aria-pressed', isLiked.toString());
  }
  function updateShareButton(isShared) {
    shareButton.classList.toggle('shared', isShared);
    shareButton.setAttribute('aria-pressed', isShared.toString());
  }

  function toggleLike() {
    if (!currentPost) return;
    liked = !liked;
    modalLikes += liked ? 1 : -1;
    updateLikeButton(liked);
    updateStatsText();
    sendGoogleFormLike(currentPost.postId, liked ? 1 : -1);
  }

  function toggleShare() {
    if (!currentPost) return;
    shared = !shared;
    modalShares += shared ? 1 : -1;
    updateShareButton(shared);
    updateStatsText();
    if (shared) {
      sendGoogleFormShare(currentPost.postId, 1);
    }
  }

  commentInput.addEventListener('input', () => {
    commentSubmit.disabled = commentInput.value.trim().length === 0;
  });

  function renderComments() {
    commentsList.innerHTML = '';
    if (modalComments.length === 0) {
      commentsList.innerHTML = '<p style="color:#8e8e8e; font-style: italic;">Aucun commentaire</p>';
      return;
    }
    modalComments.forEach(c => {
      const d = document.createElement('div');
      d.className = 'comment';
      d.innerHTML = `<strong>${escapeHtml(c.user)} :</strong> ${escapeHtml(c.text)}`;
      commentsList.appendChild(d);
    });
  }

  function submitComment(e) {
    e.preventDefault();
    if (!currentPost) return;
    const text = commentInput.value.trim();
    if (!text) return;
    modalComments.push({ user: 'Vous', text });
    renderComments();
    updateStatsText();
    sendGoogleFormComment(currentPost.postId, text);
    commentInput.value = '';
    commentSubmit.disabled = true;
  }

  function focusComment() {
    commentInput.focus();
  }

  function escapeHtml(s) {
    return s.replace(/[&<>"']/g, m => {
      return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m];
    });
  }

  // Google Forms sending
  function sendGoogleFormLike(postId, value) {
    const entry = googleFormEntryIDs[postId]?.like;
    if (!entry) return;
    sendToGoogleForm({ [entry]: value });
  }
  function sendGoogleFormComment(postId, comment) {
    const entry = googleFormEntryIDs[postId]?.comment;
    if (!entry) return;
    sendToGoogleForm({ [entry]: comment });
  }
  function sendGoogleFormShare(postId, value) {
    // If your form has a share field, send it; else skip
  }
  function sendToGoogleForm(data) {
    const formData = new FormData();
    for (const key in data) {
      formData.append(key, data[key]);
    }
    fetch(googleFormBaseURL, {
      method: 'POST',
      mode: 'no-cors',
      body: formData
    }).catch(err => {
      // silent catch
    });
  }

  // Initial render
  renderPosts();
</script>

</body>
</html>

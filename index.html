<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>vues_naturelles - Profil Nature</title>
<style>
  /* Your original CSS here - for brevity, only key styles included */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Roboto', sans-serif;
    background: #fafafa;
    max-width: 600px;
    margin: 20px auto;
    color: #262626;
  }
  header {
    display: flex;
    padding: 20px;
    align-items: center;
    border-bottom: 1px solid #dbdbdb;
    background: white;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .avatar {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    background-size: cover;
    background-position: center;
    margin-right: 20px;
    border: 2px solid #3897f0;
  }
  .profile-info {
    flex: 1;
  }
  .username {
    font-weight: 700;
    font-size: 1.6em;
    margin-bottom: 4px;
  }
  .bio {
    font-size: 0.9em;
    color: #8e8e8e;
    margin-bottom: 12px;
  }
  .follow-stats {
    display: flex;
    gap: 20px;
  }
  .follow-stats div {
    font-weight: 700;
  }
  .follow-stats div span {
    font-weight: 400;
    color: #8e8e8e;
    margin-left: 5px;
  }
  main {
    padding: 10px 0;
  }
  .posts-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2px;
  }
  .post {
    position: relative;
    cursor: pointer;
    overflow: hidden;
    background: black;
    aspect-ratio: 1 / 1;
  }
  .post img {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: cover;
    transition: transform 0.3s ease;
  }
  .post:hover img {
    transform: scale(1.1);
  }
  #modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    z-index: 2000;
    padding: 15px;
  }
  #modal.active {
    display: flex;
  }
  #modal-content {
    background: white;
    max-width: 500px;
    width: 100%;
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }
  #modal-header {
    display: flex;
    align-items: center;
    padding: 15px;
    border-bottom: 1px solid #dbdbdb;
  }
  #modal-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-size: cover;
    background-position: center;
    margin-right: 12px;
    border: 2px solid #3897f0;
  }
  #modal-username {
    font-weight: 700;
    font-size: 1.1em;
  }
  #modal-close {
    margin-left: auto;
    font-size: 28px;
    cursor: pointer;
    color: #999;
  }
  #modal-close:hover {
    color: #333;
  }
  #modal-image {
    width: 100%;
    max-height: 350px;
    object-fit: cover;
  }
  #modal-interactions {
    padding: 15px;
  }
  .buttons {
    display: flex;
    gap: 20px;
    margin-bottom: 10px;
  }
  button {
    background: none;
    border: none;
    font-size: 1.8em;
    cursor: pointer;
    color: #262626;
    transition: color 0.3s;
    user-select: none;
  }
  button:hover {
    color: #3897f0;
  }
  button.liked {
    color: #ed4956;
  }
  button.shared {
    color: #42a5f5;
  }
  #stats-text {
    font-weight: 700;
    margin-bottom: 12px;
  }
  #comments-list {
    max-height: 140px;
    overflow-y: auto;
    margin-bottom: 12px;
    border-top: 1px solid #dbdbdb;
    padding-top: 10px;
  }
  .comment {
    margin-bottom: 8px;
    font-size: 0.9em;
  }
  .comment strong {
    margin-right: 6px;
  }
  #comment-form {
    display: flex;
    gap: 10px;
  }
  #comment-input {
    flex: 1;
    padding: 8px 10px;
    border: 1px solid #dbdbdb;
    border-radius: 20px;
    font-size: 1em;
  }
  #comment-submit {
    background: none;
    border: none;
    color: #3897f0;
    font-weight: 700;
    cursor: pointer;
    font-size: 1em;
    padding: 0 10px;
  }
  #comment-submit:disabled {
    color: #ccc;
    cursor: default;
  }
  #comments-list::-webkit-scrollbar {
    width: 5px;
  }
  #comments-list::-webkit-scrollbar-thumb {
    background-color: #ccc;
    border-radius: 10px;
  }
</style>
</head>
<body>

<header>
  <div class="avatar" style="background-image:url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=200&q=80')"></div>
  <div class="profile-info">
    <div class="username">vues_naturelles</div>
    <div class="bio">Partage des plus beaux paysages du monde ðŸŒ„ðŸŒ¿</div>
    <div class="follow-stats">
      <div><strong>24,567</strong><span> abonnÃ©s</span></div>
      <div><strong>482</strong><span> abonnements</span></div>
    </div>
  </div>
</header>

<main>
  <div class="posts-grid" id="posts-grid" aria-live="polite" aria-label="Galerie de photos"></div>
</main>

<!-- Modal -->
<div id="modal" role="dialog" aria-modal="true" aria-labelledby="modal-username">
  <div id="modal-content">
    <div id="modal-header">
      <div id="modal-avatar" style="background-image:url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=200&q=80')"></div>
      <div id="modal-username">vues_naturelles</div>
      <div id="modal-close" onclick="closeModal()" aria-label="Fermer la fenÃªtre modale">&times;</div>
    </div>
    <img id="modal-image" src="" alt="Photo du post agrandie" />
    <div id="modal-interactions">
      <div class="buttons">
        <button id="like-button" title="Jâ€™aime" aria-pressed="false" onclick="toggleLike()" aria-label="Bouton jâ€™aime">â™¡</button>
        <button id="share-button" title="Partager" aria-pressed="false" onclick="toggleShare()" aria-label="Bouton partager">â†»</button>
        <button id="comment-button" title="Commenter" onclick="focusComment()" aria-label="Bouton commenter">ðŸ’¬</button>
      </div>
      <div id="stats-text" aria-live="polite"></div>
      <div id="comments-list" aria-live="polite"></div>
      <form id="comment-form" onsubmit="submitComment(event)" aria-label="Formulaire de commentaire">
        <input
          type="text"
          id="comment-input"
          placeholder="Ajouter un commentaire..."
          aria-label="Ajouter un commentaire"
          autocomplete="off"
          required
        />
        <button type="submit" id="comment-submit" disabled>Publier</button>
      </form>
    </div>
  </div>
</div>

<script>
  // Your Google Form URL (change to your actual form URL)
  const googleFormBaseURL = 'https://docs.google.com/forms/d/e/1FAIpQLSfT1XPLZb1qMxHSbDq4VvXkrZYQijFwn18lgL7cu8Mt2mWTkQ/formResponse';

  // Post to Google Form entry IDs by post number (1-based)
  const googleFormEntryIDs = {
    1: { like: 'entry.101173465', comment: 'entry.2047071178' },
    2: { like: 'entry.2104023893', comment: 'entry.1287388776' },
    3: { like: 'entry.744453841',  comment: 'entry.1080020578' },
    4: { like: 'entry.2145982999', comment: 'entry.200964838' },
    5: { like: 'entry.90484567',   comment: 'entry.2000027487' },
    6: { like: 'entry.750466602',  comment: 'entry.1558323089' },
    7: { like: 'entry.1856103927', comment: 'entry.1614154253' },
    8: { like: 'entry.157235196',  comment: 'entry.189285210' },
    9: { like: 'entry.1813427459', comment: 'entry.217981815' },
    10:{ like: 'entry.909669417',  comment: 'entry.1548024541' }
  };

  // 10 scenic posts (postId matches keys above)
  const posts = [
    { postId: 1, image: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=800&q=80', likes: 108, comments: [] },
    { postId: 2, image: 'https://images.unsplash.com/photo-1500534623283-312aade485b7?auto=format&fit=crop&w=800&q=80', likes: 48, comments: [] },
    { postId: 3, image: 'https://images.unsplash.com/photo-1468071174046-657d9d351a40?auto=format&fit=crop&w=800&q=80', likes: 78, comments: [] },
    { postId: 4, image: 'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=800&q=80', likes: 205, comments: [] },
    { postId: 5, image: 'https://images.unsplash.com/photo-1445820133077-ec956e595e9b?auto=format&fit=crop&w=800&q=80', likes: 18, comments: [] },
    { postId: 6, image: 'https://images.unsplash.com/photo-1442406964439-e46ab8eff7c4?auto=format&fit=crop&w=800&q=80', likes: 120, comments: [] },
    { postId: 7, image: 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=800&q=80', likes: 95, comments: [] },
    { postId: 8, image: 'https://images.unsplash.com/photo-1472214103451-9374bd1c798e?auto=format&fit=crop&w=800&q=80', likes: 64, comments: [] },
    { postId: 9, image: 'https://images.unsplash.com/photo-1500534314209-a25be79f67ae?auto=format&fit=crop&w=800&q=80', likes: 55, comments: [] },
    { postId: 10,image: 'https://images.unsplash.com/photo-1465311443246-53f25002f8ca?auto=format&fit=crop&w=800&q=80', likes: 83, comments: [] }
  ];

  // Shuffle function
  function shuffle(array) {
    let currentIndex = array.length, randomIndex;
    while (currentIndex !== 0) {
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex--;
      [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
    }
    return array;
  }

  // Globals for modal
  let currentPost = null;
  let liked = false;
  let shared = false;

  // Render posts grid shuffled
  const postsGrid = document.getElementById('posts-grid');
  function renderPosts() {
    const shuffledPosts = shuffle([...posts]);
    postsGrid.innerHTML = '';
    shuffledPosts.forEach(post => {
      const div = document.createElement('div');
      div.className = 'post';
      div.setAttribute('tabindex', 0);
      div.setAttribute('role', 'button');
      div.setAttribute('aria-label', `Photo paysage numÃ©ro ${post.postId}`);
      div.dataset.postId = post.postId;
      div.innerHTML = `<img src="${post.image}" alt="Paysage ${post.postId}">`;
      div.onclick = () => openModal(post.postId);
      div.onkeypress = (e) => {
        if(e.key === 'Enter' || e.key === ' ') {
          openModal(post.postId);
          e.preventDefault();
        }
      };
      postsGrid.appendChild(div);
    });
  }

  // Open modal with post info
  function openModal(postId) {
    currentPost = posts.find(p => p.postId === postId);
    liked = false;
    shared = false;

    document.getElementById('modal-image').src = currentPost.image;
    document.getElementById('like-button').classList.remove('liked');
    document.getElementById('like-button').setAttribute('aria-pressed', 'false');
    document.getElementById('share-button').classList.remove('shared');
    document.getElementById('share-button').setAttribute('aria-pressed', 'false');
    document.getElementById('stats-text').textContent = `${currentPost.likes} jâ€™aime`;
    renderComments();

    document.getElementById('modal').classList.add('active');
    document.getElementById('comment-input').value = '';
    document.getElementById('comment-submit').disabled = true;
  }

  // Close modal
  function closeModal() {
    document.getElementById('modal').classList.remove('active');
  }

  // Toggle like
  function toggleLike() {
    if (!currentPost) return;
    const likeBtn = document.getElementById('like-button');
    liked = !liked;
    if (liked) {
      currentPost.likes++;
      likeBtn.classList.add('liked');
      likeBtn.setAttribute('aria-pressed', 'true');
    } else {
      currentPost.likes--;
      likeBtn.classList.remove('liked');
      likeBtn.setAttribute('aria-pressed', 'false');
    }
    document.getElementById('stats-text').textContent = `${currentPost.likes} jâ€™aime`;

    // Send like/unlike to Google Form
    sendInteraction(currentPost.postId, 'like', liked ? 'like' : '');
  }

  // Toggle share (local only)
  function toggleShare() {
    if (!currentPost) return;
    const shareBtn = document.getElementById('share-button');
    shared = !shared;
    if (shared) {
      shareBtn.classList.add('shared');
      shareBtn.setAttribute('aria-pressed', 'true');
      alert("Merci de partager cette belle photo !");
    } else {
      shareBtn.classList.remove('shared');
      shareBtn.setAttribute('aria-pressed', 'false');
    }
  }

  // Focus comment input
  function focusComment() {
    document.getElementById('comment-input').focus();
  }

  // Render comments list
  function renderComments() {
    const commentsList = document.getElementById('comments-list');
    commentsList.innerHTML = '';
    currentPost.comments.forEach(c => {
      const div = document.createElement('div');
      div.className = 'comment';
      div.innerHTML = `<strong>${c.user} :</strong> ${c.text}`;
      commentsList.appendChild(div);
    });
  }

  // Enable/disable comment submit button
  document.getElementById('comment-input').addEventListener('input', (e) => {
    document.getElementById('comment-submit').disabled = e.target.value.trim() === '';
  });

  // Submit comment
  function submitComment(e) {
    e.preventDefault();
    if (!currentPost) return;
    const input = document.getElementById('comment-input');
    const text = input.value.trim();
    if (!text) return;

    // Add comment locally
    currentPost.comments.push({ user: 'Vous', text });
    renderComments();
    input.value = '';
    document.getElementById('comment-submit').disabled = true;

    // Send comment to Google Form
    sendInteraction(currentPost.postId, 'comment', text);
  }

  // Send interaction to Google Form by creating and submitting a hidden form
  function sendInteraction(postId, type, value) {
    if (!googleFormEntryIDs[postId]) return;
    let entryId;
    if (type === 'like') {
      entryId = googleFormEntryIDs[postId].like;
    } else if (type === 'comment') {
      entryId = googleFormEntryIDs[postId].comment;
    } else {
      return;
    }
    if (!value) return; // no need to send empty values

    // Create form
    const form = document.createElement('form');
    form.action = googleFormBaseURL;
    form.method = 'POST';
    form.target = '_blank';  // avoid page reload on submit

    // Create hidden input with the right entry id and value
    const input = document.createElement('input');
    input.type = 'hidden';
    input.name = entryId;
    input.value = value;
    form.appendChild(input);

    document.body.appendChild(form);
    form.submit();
    document.body.removeChild(form);
  }

  // Close modal on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && document.getElementById('modal').classList.contains('active')) {
      closeModal();
    }
  });

  renderPosts();
</script>

</body>
</html>
